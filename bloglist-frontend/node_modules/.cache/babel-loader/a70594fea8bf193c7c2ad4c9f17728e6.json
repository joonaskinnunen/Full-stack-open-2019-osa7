{"ast":null,"code":"import _objectSpread from \"/Users/joonaskinnunen/Projects/Full-stack-open-2019-osa7/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/Users/joonaskinnunen/Projects/Full-stack-open-2019-osa7/bloglist-frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/joonaskinnunen/Projects/Full-stack-open-2019-osa7/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"/Users/joonaskinnunen/Projects/Full-stack-open-2019-osa7/bloglist-frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/Users/joonaskinnunen/Projects/Full-stack-open-2019-osa7/bloglist-frontend/src/App.js\";\nimport React, { useState, useEffect } from 'react';\nimport Blog from './components/Blog';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport NewBlog from './components/NewBlog';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport { useField } from './hooks';\n\nvar App = function App() {\n  var _useField = useField('text'),\n      _useField2 = _slicedToArray(_useField, 1),\n      username = _useField2[0];\n\n  var _useField3 = useField('password'),\n      _useField4 = _slicedToArray(_useField3, 1),\n      password = _useField4[0];\n\n  var _useState = useState([]),\n      _useState2 = _slicedToArray(_useState, 2),\n      blogs = _useState2[0],\n      setBlogs = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      user = _useState4[0],\n      setUser = _useState4[1];\n\n  var _useState5 = useState({\n    message: null\n  }),\n      _useState6 = _slicedToArray(_useState5, 2),\n      notification = _useState6[0],\n      setNotification = _useState6[1];\n\n  useEffect(function () {\n    blogService.getAll().then(function (blogs) {\n      setBlogs(blogs);\n    });\n  }, []);\n  useEffect(function () {\n    var loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser');\n\n    if (loggedUserJSON) {\n      var _user = JSON.parse(loggedUserJSON);\n\n      setUser(_user);\n      blogService.setToken(_user.token);\n    }\n  }, []);\n\n  var notify = function notify(message) {\n    var type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'success';\n    setNotification({\n      message: message,\n      type: type\n    });\n    setTimeout(function () {\n      return setNotification({\n        message: null\n      });\n    }, 10000);\n  };\n\n  var handleLogin =\n  /*#__PURE__*/\n  function () {\n    var _ref = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee(event) {\n      var _user2;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              event.preventDefault();\n              _context.prev = 1;\n              _context.next = 4;\n              return loginService.login({\n                username: username.value,\n                password: password.value\n              });\n\n            case 4:\n              _user2 = _context.sent;\n              window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(_user2));\n              blogService.setToken(_user2.token);\n              setUser(_user2);\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](1);\n              notify('wrong username of password', 'error');\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[1, 10]]);\n    }));\n\n    return function handleLogin(_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var handleLogout = function handleLogout() {\n    setUser(null);\n    blogService.destroyToken();\n    window.localStorage.removeItem('loggedBlogAppUser');\n  };\n\n  var createBlog =\n  /*#__PURE__*/\n  function () {\n    var _ref2 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee2(blog) {\n      var createdBlog;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return blogService.create(blog);\n\n            case 2:\n              createdBlog = _context2.sent;\n              console.log(createdBlog);\n              newBlogRef.current.toggleVisibility();\n              blogService.getAll().then(function (blogs) {\n                setBlogs(blogs);\n              });\n              notify(\"a new blog \".concat(createdBlog.title, \" by \").concat(createdBlog.author, \" added\"));\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function createBlog(_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var likeBlog =\n  /*#__PURE__*/\n  function () {\n    var _ref3 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee3(blog) {\n      var likedBlog, updatedBlog;\n      return _regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              likedBlog = _objectSpread({}, blog, {\n                likes: blog.likes + 1\n              });\n              _context3.next = 3;\n              return blogService.update(likedBlog);\n\n            case 3:\n              updatedBlog = _context3.sent;\n              setBlogs(blogs.map(function (b) {\n                return b.id === blog.id ? updatedBlog : b;\n              }));\n              notify(\"blog \".concat(updatedBlog.title, \" by \").concat(updatedBlog.author, \" liked!\"));\n\n            case 6:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function likeBlog(_x3) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  var removeBlog =\n  /*#__PURE__*/\n  function () {\n    var _ref4 = _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee4(blog) {\n      var ok;\n      return _regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              ok = window.confirm(\"remove blog \".concat(blog.title, \" by \").concat(blog.author));\n\n              if (!ok) {\n                _context4.next = 6;\n                break;\n              }\n\n              _context4.next = 4;\n              return blogService.remove(blog);\n\n            case 4:\n              setBlogs(blogs.filter(function (b) {\n                return b.id !== blog.id;\n              }));\n              notify(\"blog \".concat(blog.title, \" by \").concat(blog.author, \" removed!\"));\n\n            case 6:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4);\n    }));\n\n    return function removeBlog(_x4) {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n\n  if (user === null) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89\n      },\n      __self: this\n    }, React.createElement(\"h2\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 90\n      },\n      __self: this\n    }, \"log in to application\"), React.createElement(Notification, {\n      notification: notification,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92\n      },\n      __self: this\n    }), React.createElement(\"form\", {\n      onSubmit: handleLogin,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 94\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, \"k\\xE4ytt\\xE4j\\xE4tunnus\", React.createElement(\"input\", Object.assign({}, username, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }))), React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"salasana\", React.createElement(\"input\", Object.assign({}, password, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }))), React.createElement(\"button\", {\n      type: \"submit\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, \"kirjaudu\")));\n  }\n\n  var newBlogRef = React.createRef();\n\n  var byLikes = function byLikes(b1, b2) {\n    return b2.likes - b1.likes;\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, \"blogs\"), React.createElement(Notification, {\n    notification: notification,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, user.name, \" logged in\"), React.createElement(\"button\", {\n    onClick: handleLogout,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, \"logout\"), React.createElement(Togglable, {\n    buttonLabel: \"create new\",\n    ref: newBlogRef,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }, React.createElement(NewBlog, {\n    createBlog: createBlog,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  })), blogs.sort(byLikes).map(function (blog) {\n    return React.createElement(Blog, {\n      key: blog.id,\n      blog: blog,\n      like: likeBlog,\n      remove: removeBlog,\n      user: user,\n      creator: blog.user.username === user.username,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127\n      },\n      __self: this\n    });\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/joonaskinnunen/Projects/Full-stack-open-2019-osa7/bloglist-frontend/src/App.js"],"names":["React","useState","useEffect","Blog","blogService","loginService","NewBlog","Notification","Togglable","useField","App","username","password","blogs","setBlogs","user","setUser","message","notification","setNotification","getAll","then","loggedUserJSON","window","localStorage","getItem","JSON","parse","setToken","token","notify","type","setTimeout","handleLogin","event","preventDefault","login","value","setItem","stringify","handleLogout","destroyToken","removeItem","createBlog","blog","create","createdBlog","console","log","newBlogRef","current","toggleVisibility","title","author","likeBlog","likedBlog","likes","update","updatedBlog","map","b","id","removeBlog","ok","confirm","remove","filter","createRef","byLikes","b1","b2","name","sort"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Blog from './components/Blog'\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport NewBlog from './components/NewBlog'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\nimport { useField } from './hooks'\n\nconst App = () => {\n  const [username] = useField('text')\n  const [password] = useField('password')\n  const [blogs, setBlogs] = useState([])\n  const [user, setUser] = useState(null)\n  const [notification, setNotification] = useState({\n    message: null\n  })\n\n  useEffect(() => {\n    blogService.getAll().then(blogs => {\n      setBlogs(blogs)\n    })\n  }, [])\n\n  useEffect(() => {\n    const loggedUserJSON = window.localStorage.getItem('loggedBlogAppUser')\n    if (loggedUserJSON) {\n      const user = JSON.parse(loggedUserJSON)\n      setUser(user)\n      blogService.setToken(user.token)\n    }\n  }, [])\n\n  const notify = (message, type = 'success') => {\n    setNotification({ message, type })\n    setTimeout(() => setNotification({ message: null }), 10000)\n  }\n\n  const handleLogin = async (event) => {\n    event.preventDefault()\n    try {\n      const user = await loginService.login({\n        username: username.value,\n        password: password.value\n      })\n\n      window.localStorage.setItem('loggedBlogAppUser', JSON.stringify(user))\n      blogService.setToken(user.token)\n      setUser(user)\n    } catch (exception) {\n      notify('wrong username of password', 'error')\n    }\n  }\n\n  const handleLogout = () => {\n    setUser(null)\n    blogService.destroyToken()\n    window.localStorage.removeItem('loggedBlogAppUser')\n  }\n\n  const createBlog = async (blog) => {\n    const createdBlog = await blogService.create(blog)\n    console.log(createdBlog)\n    newBlogRef.current.toggleVisibility()\n    blogService.getAll().then(blogs => {\n      setBlogs(blogs)\n    })\n    notify(`a new blog ${createdBlog.title} by ${createdBlog.author} added`)\n  }\n\n  const likeBlog = async (blog) => {\n    const likedBlog = { ...blog, likes: blog.likes + 1}\n    const updatedBlog = await blogService.update(likedBlog)\n    setBlogs(blogs.map(b => b.id === blog.id ? updatedBlog : b))\n    notify(`blog ${updatedBlog.title} by ${updatedBlog.author} liked!`)\n  }\n\n  const removeBlog = async (blog) => {\n    const ok = window.confirm(`remove blog ${blog.title} by ${blog.author}`)\n    if (ok) {\n      await blogService.remove(blog)\n      setBlogs(blogs.filter(b => b.id !== blog.id))\n      notify(`blog ${blog.title} by ${blog.author} removed!`)\n    }\n  }\n\n  if (user === null) {\n    return (\n      <div>\n        <h2>log in to application</h2>\n\n        <Notification notification={notification} />\n\n        <form onSubmit={handleLogin}>\n          <div>\n            käyttäjätunnus\n            <input {...username}/>\n          </div>\n          <div>\n            salasana\n            <input {...password} />\n          </div>\n          <button type=\"submit\">kirjaudu</button>\n        </form>\n      </div>\n    )\n  }\n\n  const newBlogRef = React.createRef()\n\n  const byLikes = (b1, b2) => b2.likes - b1.likes\n\n  return (\n    <div>\n      <h2>blogs</h2>\n\n      <Notification notification={notification} />\n\n      <p>{user.name} logged in</p>\n      <button onClick={handleLogout}>logout</button>\n\n      <Togglable buttonLabel='create new' ref={newBlogRef}>\n        <NewBlog createBlog={createBlog} />\n      </Togglable>\n\n      {blogs.sort(byLikes).map(blog =>\n        <Blog\n          key={blog.id}\n          blog={blog}\n          like={likeBlog}\n          remove={removeBlog}\n          user={user}\n          creator={blog.user.username === user.username}\n        />\n      )}\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}